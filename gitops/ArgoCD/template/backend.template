---
apiVersion: argoproj.io/v1alpha1
kind: Application
metadata:
  name: $SERVICE_NAME-$BRANCHE_NAME
  namespace: argocd
spec:
  destination:
    namespace: $BRANCHE_NAME
    server: 'https://rancher.hasti.co/k8s/clusters/c-m-qrrtx65z'
  project: backend
  source:
    path: $REPO_NAME/$SERVICE_NAME_LOWER/manifests
    repoURL: https://hig-devops.gig.services/HIT/Hastim/_git/gitops
    targetRevision: $BRANCHE_NAME
  ignoreDifferences:
  - group: apps
    kind: Deployment
    name: $SERVICE_NAME
    namespace: $BRANCHE_NAME
    jsonPointers:
    - /spec/replicas
  - group: autoscaling
    kind: HorizontalPodAutoscaler
    name: $SERVICE_NAME
    namespace: $BRANCHE_NAME
    jsonPointers:
    - /spec/metrics    